<?php if(!empty( $_POST['s'] )): ?>

<h1 class="header"><?php $x = ( $this->total == 1 ) ? "resultaat": "resultaten"; echo $this->total . '&nbsp'.   $x; ?> voor zoekterm "<?php echo $this->search; ?>"</h1>

<?php else: ?>

<h1 class="header">Zoek naar vragen</h1>

<?php endif; ?>

<div class="shadow-border">&nbsp;</div>

  <div class="search-results">

    <form action="zoeken" method="POST">

        <input type="search" name="s" class="search-input" value="<?php echo $this->search; ?>" />
        <input type="submit" class="hidden" name="submit" />

    </form> 

	<?php if($this->results): ?>

  		<ul id="results-questions">
  			
  			<?php 
  				$i = 0;
  				foreach($this->results as $result):
  					if (strlen($result['name']) <= 70) {
					   $result['name'] = $result['name'];
					} else {
					   $result['name'] = substr($result['name'], 0, strpos(wordwrap($result['name'], 70), "\n")) . "...";
					}
  					echo '<li><a href="question/' . $result['url'] . '">' . str_ireplace( $this->search, "<span>" . $this->search . "</span>", $result['name'] ) . '</a></li>
            <div class="shadow-border-search">&nbsp;</div>';
  				endforeach;
  			?>

  		</ul>

	  	<?php if( $this->total > 10): ?>
	  		<span id="loadmore" loaded="10">Meer vragen</span>
	  	<?php endif; ?>

  	<?php endif; ?>

</div>

<script type="text/javascript">

$(function() {
    $('#loadmore').click(function() {
    	
    	var loaded = parseInt( $(this).attr('loaded') );
    	var input = $(".search-input").val();

	    	$.ajax({
		        url:'zoeken-meer',
		        type:'get',
            dataType: "json",
            contentType: "application/jsons", 
		        data:{'from': loaded, 'to' : loaded + 10, 's' : input},
		        success: function (data) {
                for (var i in data) { 
                  if(data.length < 10) {
                    $('#loadmore').hide();
                  }
                  $('#results-questions').append($('<li><a href="question/' + data[i]['url'] + '">' + data[i]['name'].replace(input, '<span>' + input + '</span>') + '</a></li><div class="shadow-border-search">&nbsp;</div>').fadeIn(500));
                }
		            $('#loadmore').attr('loaded', loaded + 10);
		        }
	    	});
	});
});

</script>